{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>لوحة الإدارة</h3>
  <div>مدير: <strong>{{ admin }}</strong></div>
</div>

<div class="card p-3 mb-3">
  <form method="post" class="row g-2">
    <div class="col-5"><input name="room" class="form-control" placeholder="اسم الغرفة"></div>
    <div class="col-5"><input name="desc" class="form-control" placeholder="وصف"></div>
    <div class="col-2"><button name="add_room" class="btn btn-primary w-100">إضافة</button></div>
  </form>
</div>

<div class="card p-3 mb-3">
  <h5>المستخدمون</h5>
  <table class="table table-sm">
    <thead><tr><th>الاسم</th><th>دور</th><th>وسم</th><th>الحالة</th><th>تغيير وسم</th></tr></thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u[0] }}</td>
        <td>{{ u[1] }}</td>
        <td>{{ u[2] }}</td>
        <td>{{ u[3] }}</td>
        <td>
          <form method="post" class="d-flex gap-1">
            <input type="hidden" name="uname" value="{{ u[0] }}">
            <select name="badge" class="form-select form-select-sm">
              <option value="owner">مدير</option>
              <option value="mod">مشرف</option>
              <option value="vip">مميز</option>
              <option value="member" selected>عضو</option>
            </select>
            <button name="set_badge" class="btn btn-sm btn-outline-primary">حفظ</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="row">
  {% for r in rooms %}
    <div class="col-12 mb-2">
      <div class="room-card d-flex justify-content-between align-items-center">
        <div>
          <div class="fw-bold">{{ r[1] }}</div>
          <div class="text-muted small">{{ r[2] }}</div>
        </div>
        <div>
          <a class="btn btn-sm btn-outline-primary" href="{{ url_for('chat', room=r[1]) }}">فتح</a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="col-12"><div class="alert alert-info">لا توجد غرف بعد</div></div>
  {% endfor %}
</div>
{% endblock %}
